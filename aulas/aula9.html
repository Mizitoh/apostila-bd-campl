<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aula 8 - C√°lculos e manipula√ß√£o de string</title>
    <link rel="icon" type="image/png" href="./../assets/imagens/caderno.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./../assets/css/style.css" />
  </head>
  <body>
    <div class="container">
      <main class="content">
        <h1>Aula 9 - RESTORE - Recuperando backups</h1>

        <h2>O que √© RESTORE?</h2>
        <p>
          <code>RESTORE</code> √© o processo de recuperar dados a partir de um
          backup. √â literalmente o oposto de BACKUP: enquanto backup salva seus
          dados, restore os devolve para o banco de dados.
        </p>
        <p>
          Quando voc√™ faz um restore, voc√™ est√° restaurando o banco de dados (ou
          uma tabela) para um estado anterior, recuperando todos os dados,
          estruturas, √≠ndices e configura√ß√µes que existiam no momento em que o
          backup foi criado.
        </p>

        <hr />

        <h2>Quando usar RESTORE?</h2>
        <ul>
          <li>
            <strong>Ap√≥s uma perda de dados:</strong> Algu√©m deletou dados
            importantes acidentalmente
          </li>
          <li>
            <strong>Depois de um ataque:</strong> Ransomware ou hacker corrompeu
            o banco
          </li>
          <li>
            <strong>Erro em UPDATE/DELETE:</strong> Um comando SQL errado afetou
            muitos registros
          </li>
          <li>
            <strong>Recupera√ß√£o de desastre:</strong> O servidor inteiro falhou
            ou foi perdido
          </li>
          <li>
            <strong>Teste de dados:</strong> Voc√™ quer testar em um ambiente de
            teste sem riscar os dados reais
          </li>
          <li>
            <strong>Migra√ß√£o de ambientes:</strong> Restaurar um backup em um
            servidor diferente
          </li>
          <li>
            <strong>Auditoria:</strong> Verificar como os dados estavam em um
            momento espec√≠fico do passado
          </li>
        </ul>

        <hr />

        <h2>Tipos de RESTORE</h2>

        <h3>1. Restore completo do banco</h3>
        <p>
          Restaura o banco inteiro a partir de um backup. Todos os dados voltam
          ao estado em que estavam quando o backup foi feito.
        </p>
        <ul>
          <li>‚úÖ Recupera tudo (tabelas, √≠ndices, constraints, triggers)</li>
          <li>‚ö†Ô∏è Sobrescreve dados atuais (perder dados depois do backup)</li>
          <li>‚è±Ô∏è Pode levar tempo em bancos grandes</li>
        </ul>

        <h3>2. Restore de tabela espec√≠fica</h3>
        <p>
          Restaura apenas uma tabela de um backup. √ötil quando apenas uma tabela
          foi corrompida ou deletada.
        </p>
        <ul>
          <li>‚úÖ N√£o afeta outras tabelas</li>
          <li>‚úÖ Mais r√°pido que restore completo</li>
          <li>‚ö†Ô∏è Requer que a tabela j√° exista ou seja criada primeiro</li>
        </ul>

        <h3>3. Restore ponto-no-tempo (Point in Time Recovery)</h3>
        <p>
          Restaura o banco para um momento espec√≠fico (ex: "como estava em 10 de
          janeiro √†s 14:30"). √ötil para recuperar de erros recentes sem perder
          tudo depois do erro.
        </p>
        <ul>
          <li>‚úÖ Recupera apenas at√© um momento espec√≠fico</li>
          <li>‚úÖ N√£o perde mudan√ßas depois do ponto de restaura√ß√£o</li>
          <li>‚ö†Ô∏è Requer logs de transa√ß√£o preservados</li>
        </ul>

        <h3>4. Restore seletivo</h3>
        <p>
          Restaura apenas certos dados de um backup (ex: restaurar apenas
          registros de um cliente espec√≠fico de uma tabela). Geralmente feito
          com SQL INSERT combinado com backups de tabela.
        </p>

        <hr />

        <h2>Checklist antes de fazer RESTORE</h2>
        <p>Sempre siga estes passos para evitar problemas:</p>
        <ul>
          <li>
            ‚úÖ <strong>Verifique a data do backup:</strong> Confirme que √© o
            backup certo
          </li>
          <li>
            ‚úÖ <strong>Teste em ambiente de desenvolvimento:</strong> N√£o
            restaure direto em produ√ß√£o
          </li>
          <li>
            ‚úÖ <strong>Avise seus usu√°rios:</strong> O banco ficar√° indispon√≠vel
            durante o restore
          </li>
          <li>
            ‚úÖ <strong>Tenha um plano B:</strong> Se der errado, voc√™ tem outro
            backup?
          </li>
          <li>
            ‚úÖ <strong>Verifique permiss√µes:</strong> Voc√™ tem permiss√£o para
            restaurar?
          </li>
          <li>
            ‚úÖ <strong>Libere espa√ßo em disco:</strong> Certifique-se que h√°
            espa√ßo suficiente
          </li>
          <li>
            ‚úÖ <strong>Fa√ßa backup do estado atual:</strong> Antes de
            sobrescrever, salve o estado atual
          </li>
        </ul>

        <hr />

        <h2>O que voc√™ precisa saber sobre RESTORE</h2>

        <h3>Tempo de restaura√ß√£o</h3>
        <p>
          O tempo para restaurar depende de v√°rios fatores. Um backup de 1GB
          pode levar de alguns segundos a v√°rios minutos para restaurar,
          dependendo de:
        </p>
        <ul>
          <li>Tamanho do backup</li>
          <li>Velocidade do disco</li>
          <li>Complexidade das estruturas (muitos √≠ndices = mais tempo)</li>
          <li>Pot√™ncia do servidor</li>
        </ul>

        <h3>Conflitos de constraints</h3>
        <p>
          Ao restaurar uma tabela em um banco onde ela j√° existe, pode haver
          conflitos se houver chaves estrangeiras ou identificadores √∫nicos.
          Geralmente √© necess√°rio:
        </p>
        <ul>
          <li>Deletar dados antigos da tabela</li>
          <li>Desabilitar constraints temporariamente</li>
          <li>Reabilitar constraints ap√≥s o restore</li>
        </ul>

        <h3>Espa√ßo em disco</h3>
        <p>
          Um restore precisa de espa√ßo em disco livre pelo menos do tamanho do
          backup. Se o disco est√° cheio, o restore falhar√° no meio do processo!
        </p>

        <h3>Valida√ß√£o ap√≥s restore</h3>
        <p>Sempre valide o restore:</p>
        <ul>
          <li>Contagem de registros (deve ser igual ao backup)</li>
          <li>Integridade referencial (sem orfandades)</li>
          <li>Testes de neg√≥cio (as opera√ß√µes cr√≠ticas funcionam?)</li>
        </ul>

        <hr />

        <h2>Diferen√ßa entre RESTORE e restaurar com SQL</h2>
        <table class="table table-bordered mt-3">
          <thead>
            <tr>
              <th>Aspecto</th>
              <th>RESTORE via DBeaver</th>
              <th>INSERT FROM SELECT (backup tabela)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Velocidade</td>
              <td>Muito r√°pido (arquivo bin√°rio)</td>
              <td>Mais lento (processa SQL)</td>
            </tr>
            <tr>
              <td>Restaura estrutura</td>
              <td>‚úÖ Tabelas, √≠ndices, constraints</td>
              <td>‚ùå Apenas dados</td>
            </tr>
            <tr>
              <td>Banco completo</td>
              <td>‚úÖ Poss√≠vel</td>
              <td>‚ùå Apenas tabelas individuais</td>
            </tr>
            <tr>
              <td>Facilidade</td>
              <td>Interface gr√°fica</td>
              <td>Precisa escrever SQL</td>
            </tr>
          </tbody>
        </table>

        <div class="alert alert-info mt-4" role="alert">
          üí° <strong>Dica:</strong> Use RESTORE para recupera√ß√£o completa de
          desastres. Use SQL (INSERT FROM SELECT) para recuperar dados
          espec√≠ficos de um backup de tabela.
        </div>

        <hr />

        <h2>Restaurando backup com Dbeaver</h2>

        <p>
          Crie um banco novo, depois clique com o bat√£o direito sobre ele e v√°
          em restore:
        </p>

        <div class="image-wrapper">
          <img
            src="./../assets/imagens/restoredbeaver1.png"
            alt="Passo 1 restore Dbeaver"
          />
        </div>

        <p>
          Selecione o arquivo de backup, clique em iniciar e aguarde a
          finaliza√ß√£o. Ao terminar, feche a janela:
        </p>

        <div class="image-wrapper">
          <img
            src="./../assets/imagens/restoredbeaver2.png"
            alt="Passo 2 restore Dbeaver"
          />
        </div>

        <hr />

        <h3>Conclus√£o</h3>

        <p>
          Finalizamos nosso curso de CRUD com banco de dados. Agora voc√™ j√°
          consegue entregar o projeto final que est√° na apostila e foi combinado
          em sala de aula. Parab√©ns!
        </p>
        <p>
          Lembre-se que banco de dados √© um assunto extenso e tem muito mais pra
          ler e saber. At√© a pr√≥xima!
        </p>
        <hr />

        <h2>Menu</h2>
        <div class="mt-4">
          <a href="./../index.html" class="btn btn-outline-secondary"
            >‚Üê Voltar ao In√≠cio</a
          >
          <a href="./../aulas.html" class="btn btn-outline-secondary"
            >‚Üê Voltar √†s aulas por data</a
          >
        </div>
      </main>
    </div>

    <script src="./../assets/js/sidebar.js"></script>
    <script src="./../assets/js/table-of-contents.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>
  </body>
</html>
