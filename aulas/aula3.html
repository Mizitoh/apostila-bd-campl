<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aula 3 - Linguagens de Banco de Dados (SQL)</title>
    <link rel="icon" type="image/png" href="./../assets/imagens/caderno.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./../assets/css/style.css" />
  </head>
  <body>
    <div class="container">
      <main class="content">
        <h1>Aula 3 - Linguagens de Banco de Dados (SQL)</h1>

        <h2>O que √© SQL?</h2>

        <p>
          <strong>SQL</strong> significa
          <em>Structured Query Language</em> (Linguagem de Consulta
          Estruturada).
        </p>

        <p>
          √â a <strong>linguagem padr√£o</strong> usada para se comunicar com
          bancos de dados relacionais. Com SQL voc√™ pode criar bancos, tabelas,
          inserir dados, fazer consultas, atualizar e deletar informa√ß√µes.
        </p>

        <h3>Para que serve?</h3>
        <ul>
          <li>Criar e organizar bancos de dados</li>
          <li>Inserir, consultar, atualizar e deletar dados</li>
          <li>Controlar quem pode acessar os dados</li>
          <li>Fazer relat√≥rios e an√°lises</li>
        </ul>
        <br />
        <h3>Exemplo simples:</h3>
        <pre><code class="language-sql">
-- Consultar todos os alunos
SELECT * FROM alunos;

-- Buscar alunos com nota acima de 7
SELECT nome, nota FROM alunos WHERE nota > 7;
</code></pre>

        <h3>Onde √© usado?</h3>
        <p>
          Praticamente todos os bancos de dados relacionais usam SQL:
          <strong>PostgreSQL, MySQL, SQL Server, Oracle, SQLite</strong>, etc.
        </p>

        <p>
          SQL √© a linguagem que usamos para "conversar" com bancos de dados
          relacionais! üíæ
        </p>

        <h2>Comandos SQL</h2>

        <div class="alert alert-info mt-4" role="alert">
          üí° <strong>Dica:</strong> Essa parte te√≥rica √© muito cobrada em
          concursos p√∫blicos!
          <p>
            Os comandos mais utilizados e a breve explica√ß√£o deles est√° na
            p√°gina
            <a
              href="./../cola.html"
              class="link-danger link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"
              >colinha</a
            >
            para caso queira algo mais pr√°tico.
          </p>
        </div>

        <p>
          Os comandos SQL s√£o divididos em categorias, cada uma com uma fun√ß√£o
          espec√≠fica:
        </p>

        <h2>
          DDL - Data Definition Language (Linguagem de Defini√ß√£o de Dados)
        </h2>
        <p>
          Comandos para <strong>criar e modificar a estrutura</strong> do banco
          de dados.
        </p>

        <ul>
          <li><strong>CREATE</strong> - Criar banco, tabelas, √≠ndices</li>
          <li><strong>ALTER</strong> - Modificar estrutura de tabelas</li>
          <li><strong>DROP</strong> - Deletar banco, tabelas</li>
          <li>
            <strong>TRUNCATE</strong> - Limpar todos os dados de uma tabela
          </li>
        </ul>
        <br />
        <h3>Exemplos:</h3>
        <pre><code class="language-sql">
CREATE DATABASE escola;
CREATE TABLE alunos (...);
ALTER TABLE alunos ADD COLUMN telefone VARCHAR(15);
DROP TABLE alunos;
</code></pre>

        <hr />

        <h2>
          DML - Data Manipulation Language (Linguagem de Manipula√ß√£o de Dados)
        </h2>
        <p>
          Comandos para <strong>manipular os dados</strong> dentro das tabelas
          (o famoso CRUD).
        </p>

        <ul>
          <li><strong>INSERT</strong> - Inserir dados</li>
          <li><strong>SELECT</strong> - Consultar dados</li>
          <li><strong>UPDATE</strong> - Atualizar dados</li>
          <li><strong>DELETE</strong> - Deletar dados</li>
        </ul>
        <br />
        <h3>Exemplos:</h3>
        <pre><code class="language-sql">
INSERT INTO alunos (nome, email) VALUES ('Jo√£o', 'joao@email.com');
SELECT * FROM alunos;
UPDATE alunos SET nota = 10 WHERE id = 1;
DELETE FROM alunos WHERE id = 1;
</code></pre>

        <hr />

        <h2>DCL - Data Control Language (Linguagem de Controle de Dados)</h2>
        <p>
          Comandos para <strong>controlar permiss√µes</strong> e acesso ao banco.
        </p>

        <ul>
          <li><strong>GRANT</strong> - Conceder permiss√µes</li>
          <li><strong>REVOKE</strong> - Remover permiss√µes</li>
        </ul>
        <br />
        <h3>Exemplos:</h3>
        <pre><code class="language-sql">
GRANT SELECT ON alunos TO usuario1;
REVOKE DELETE ON alunos FROM usuario1;
</code></pre>

        <hr />

        <h2>
          TCL - Transaction Control Language (Linguagem de Controle de
          Transa√ß√µes)
        </h2>
        <p>Comandos para <strong>gerenciar transa√ß√µes</strong> no banco.</p>

        <ul>
          <li>
            <strong>BEGIN</strong> ou <strong>START TRANSACTION</strong> -
            Iniciar transa√ß√£o
          </li>
          <li><strong>COMMIT</strong> - Confirmar altera√ß√µes</li>
          <li><strong>ROLLBACK</strong> - Desfazer altera√ß√µes</li>
        </ul>
        <br />
        <h3>Exemplos:</h3>
        <pre><code class="language-sql">
BEGIN;
UPDATE alunos SET nota = 10 WHERE id = 1;
COMMIT;
</code></pre>

        <hr />

        <h2>Resumo R√°pido</h2>
        <ul>
          <li>
            <strong>DDL:</strong> Criar/modificar estrutura (CREATE, ALTER,
            DROP)
          </li>
          <li>
            <strong>DML:</strong> Manipular dados (INSERT, SELECT, UPDATE,
            DELETE)
          </li>
          <li><strong>DCL:</strong> Controlar permiss√µes (GRANT, REVOKE)</li>
          <li><strong>TCL:</strong> Gerenciar transa√ß√µes (COMMIT, ROLLBACK)</li>
        </ul>

        <hr />

        <h2>Modelagem de Dados</h2>
        <p>
          N√≥s j√° criamos um banco de dados e uma tabela, mas bancos s√£o bem
          maiores e mais complexos que o que fizemos at√© agora.
        </p>
        <p>
          Antes de iniciar um projeto √© necess√°rio pensar em todos os cen√°rios e
          tabelas que o banco precisar√° para atender as necessidades daquele
          sistema. √â necess√°rio modelar o banco.
        </p>
        <p>
          O que √© a Modelagem de dados? √â o processo de criar um modelo que
          represente como os dados ser√£o armazenados e relacionados no banco de
          dados. √â como fazer uma "planta" antes de construir uma casa -
          primeiro planejamos a estrutura, pensamos em como as informa√ß√µes se
          conectam e s√≥ depois criamos as tabelas. Uma boa modelagem evita
          redund√¢ncia de dados, facilita a manuten√ß√£o e garante a integridade
          das informa√ß√µes. √â a base para um banco de dados eficiente e
          organizado! üèóÔ∏è
        </p>
        <p>
          Na modelagem desenhamos essas tabelas e marcamos o tipo de dado
          existente nela e o nome do seu atributo, os tipos e o nome √© o que
          chamamos de metadados:
        </p>

        <div class="image-wrapper">
          <img
            src="./../assets/imagens/modelagem1.png"
            alt="Modelo de tabela n√£o normalizada"
          />
        </div>

        <hr />

        <h2>Exerc√≠cio</h2>
        <div class="alert alert-warning" role="alert">
          üìù <strong>Atividade:</strong> Vamos criar uma tabela "n√£o
          normalizada" e depois entender por que precisamos normalizar. A parte
          te√≥rica de normaliza√ß√£o e relacionamento ser√° feita na pr√≥xima aula.
        </div>

        <hr />

        <div class="mb-5">
          <h2>Atividade Pr√°tica: Modelando o Banco</h2>

          <p>
            O objetivo desta atividade √© que voc√™ visualize e desenhe o processo
            de normaliza√ß√£o do esquema inicial que apresentava problemas de
            redund√¢ncia e flexibilidade. A teoria mais aprofundada vem na
            pr√≥xima aula.
          </p>

          <h3>Esquema Inicial (N√£o Normalizado)</h3>

          <div class="alert alert-info mt-4" role="alert">
            üí° <strong>Aproveitando Talentos:</strong>
            Para os alunos que j√° viram normaliza√ß√£o na faculdade, pulem a etapa
            de cria√ß√£o da tabela "aluno" e v√£o direto para o desenho da
            modelagem das tabelas normalizadas. Fa√ßam numa folha sulfite e
            entreguem para o professor na pr√≥xima aula.
          </div>

          <p>
            Vamos apagar os bancos que criamos at√© agora, vamos criar (ou
            recriar) um banco chamado escola:
          </p>

          <pre><code class="language-sql">
CREATE DATABASE escola;
        </code></pre>

          <p>Crie a tabela aluno:</p>

          <pre><code class="language-sql">
CREATE TABLE aluno (
matricula INT PRIMARY KEY,
nome VARCHAR(100),
sexo CHAR(1),
telefone1 VARCHAR(15),
telefone2 VARCHAR(15),
endereco VARCHAR(200),
curso1 VARCHAR(50),
curso2 VARCHAR(50),
professor_curso1 VARCHAR(100),
professor_curso2 VARCHAR(100),
nota_curso1 DECIMAL(4,2),
nota_curso2 DECIMAL(4,2)
);
        </code></pre>

          <p>
            Fa√ßa 5 inser√ß√µes de dados nessa tabela, segue dois exemplos, fa√ßa
            mais 3:
          </p>

          <pre><code class="language-sql">
-- Inser√ß√£o 1
INSERT INTO aluno_original (
    matricula, 
    nome, 
    sexo,
    telefone1, 
    telefone2, 
    endereco, 
    curso1, 
    curso2, 
    professor_curso1, 
    professor_curso2, 
    nota_curso1, 
    nota_curso2
) 
VALUES (
    1001,
    'Alice Silva',
    'F',
    '(11) 98765-4321',
    '(11) 3333-2222',
    'Rua das Flores, 150 - S√£o Paulo',
    'PostgreSQL Essencial',
    'Python para Dados',
    'Prof. Carlos Eduardo',
    'Profa. Juliana Santos',
    9.50,
    8.80
);

-- Inser√ß√£o 2
INSERT INTO aluno_original (
    matricula, 
    nome,
    sexo, 
    telefone1, 
    telefone2, 
    endereco, 
    curso1, 
    curso2, 
    professor_curso1, 
    professor_curso2, 
    nota_curso1, 
    nota_curso2
) 
VALUES (
    1002,
    'Bruno Mendes',
    'M',
    '(21) 99999-1111',
    NULL, -- Aluno tem apenas 1 telefone
    'Av. Central, 500 - Rio de Janeiro',
    'PostgreSQL Essencial',
    NULL, -- Aluno tem apenas 1 curso
    'Prof. Carlos Eduardo',
    NULL,
    7.00,
    NULL
);
        </code></pre>

          <p>
            Percebe quem durante a inser√ß√£o precisamos repetir dados como sexo
            do aluno, telefones, cursos e professores? Isso √© um problema de
            normaliza√ß√£o.
          </p>
          <p>Como podemos melhorar essa tabela?</p>
          <h3>ü§î Vamos Pensar Juntos...</h3>

          <p>
            Olhe atentamente para os dados que voc√™ acabou de inserir. Perceba
            alguns problemas:
          </p>

          <ul>
            <li>
              <strong>Repeti√ß√£o:</strong> O curso "PostgreSQL Essencial" aparece
              em v√°rios alunos. Se o nome do curso mudar, voc√™ teria que alterar
              em TODOS os registros!
            </li>
            <li>
              <strong>Professor repetido:</strong> "Prof. Carlos Eduardo"
              aparece m√∫ltiplas vezes. E se ele mudar de nome ou voc√™ precisar
              adicionar o e-mail dele?
            </li>
            <li>
              <strong>Desperd√≠cio:</strong> As colunas `telefone2`, `curso2`,
              `professor_curso2` ficam vazias (NULL) quando o aluno tem apenas
              um telefone ou um curso.
            </li>
            <li>
              <strong>Limita√ß√£o:</strong> E se um aluno quiser fazer 3 cursos?
              Ou ter 3 telefones? Vamos criar `curso3`, `curso4`...
              infinitamente?
            </li>
          </ul>

          <div class="alert alert-warning" role="alert">
            üí≠ <strong>Desafio de Racioc√≠nio:</strong><br />
            Pense: se voc√™ tivesse que organizar esses dados em sua casa, como
            faria?<br /><br />

            Talvez voc√™ usasse:
            <ul>
              <li>
                Uma <strong>lista separada</strong> com todos os cursos
                dispon√≠veis?
              </li>
              <li>
                Uma <strong>agenda de telefones</strong> √† parte, onde cada
                pessoa pode ter v√°rios n√∫meros?
              </li>
              <li>Um <strong>cadastro de professores</strong> independente?</li>
            </ul>
          </div>

          <p>
            √â exatamente isso que vamos fazer! Em vez de uma √∫nica tabela
            gigante com tudo misturado, vamos
            <strong
              >separar as informa√ß√µes em tabelas menores e organizadas</strong
            >, onde:
          </p>

          <ul>
            <li>Cada dado aparece <strong>apenas uma vez</strong></li>
            <li>N√£o h√° desperd√≠cio de espa√ßo com colunas vazias</li>
            <li>
              N√£o h√° limite de quantos telefones, cursos ou endere√ßos cada aluno
              pode ter
            </li>
            <li>Atualizar informa√ß√µes fica muito mais f√°cil</li>
          </ul>

          <p>
            <strong>Sua miss√£o agora:</strong> Desenhe em uma folha como voc√™
            dividiria essa tabela √∫nica em
            <strong>v√°rias tabelas menores</strong>. Pense em quais informa√ß√µes
            "fazem sentido juntas" e quais deveriam ficar separadas.
          </p>

          <p>
            Dica: Comece identificando os "grupos de informa√ß√µes" que se repetem
            ou que poderiam existir independentemente do aluno (como cursos e
            professores).
          </p>

          <pre><code class="sql">
CREATE TABLE aluno_original (
    matricula INT PRIMARY KEY,
    nome VARCHAR(100),
    sexo CHAR(1), -- Desatualizada com novos tratamentos e repeti√ß√£o (Problema: 1FN)
    telefone1 VARCHAR(15), -- Repeti√ß√£o (Problema: 1FN)
    telefone2 VARCHAR(15), -- Repeti√ß√£o (Problema: 1FN)
    endereco VARCHAR(200),
    curso1 VARCHAR(50), -- Repeti√ß√£o (Problema: 1FN)
    curso2 VARCHAR(50), -- Repeti√ß√£o (Problema: 1FN)
    professor_curso1 VARCHAR(100), -- Depend√™ncia Transitiva/Parcial (Problema: 2FN/3FN)
    professor_curso2 VARCHAR(100), -- Depend√™ncia Transitiva/Parcial (Problema: 2FN/3FN)
    nota_curso1 DECIMAL(4,2), -- Depende da combina√ß√£o (Matr√≠cula + Curso) (Problema: 2FN)
    nota_curso2 DECIMAL(4,2)  -- Depende da combina√ß√£o (Matr√≠cula + Curso) (Problema: 2FN)
);
    </code></pre>

          <div class="alert alert-warning" role="alert">
            üö® <strong>Aten√ß√£o! Quest√£o Sexo e Outros Temas Sens√≠veis</strong>
            <p>
              Enquanto programador n√£o nos interessa a pol√≠tica, quest√µes
              sexuais ou qualquer outro tema pol√™mico. Acompanhamos a sociedade
              e o dono do sistema;
            </p>
            <p>
              Se a sociedade, ou a lei, demandam uma mudan√ßa, precisamos fazer,
              gostando ou n√£o.
            </p>
            <p>
              Se o cliente n√£o quiser se adequar, tenha cl√°usulas de contrato
              para te proteger ou proteger sua empresa e, em ambos os casos,
              altera√ß√µes no sistema custam dinheiro!
            </p>
            <p>
              Dica: N√≠nguem fica rico discutindo ideias, ganhamos dinheiro
              fazendo c√≥digo.
            </p>
          </div>

          <h3 class="mt-5">Resultado do Professor</h3>

          <button
            class="btn btn-primary"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseGabarito"
            aria-expanded="false"
            aria-controls="collapseGabarito"
          >
            Mostrar Resultado do Professor
          </button>

          <div class="collapse mt-3" id="collapseGabarito">
            <div
              class="card card-body"
              style="
                background-color: var(--sidebar-bg);
                border-color: var(--border);
              "
            >
              <pre><code class="sql">
-- ========================================
-- TABELAS NORMALIZADAS DO EXERC√çCIO
-- ========================================

-- 1. TABELA DE SEXOS (inclus√£o e diversidade)
CREATE TABLE sexos (
    id SERIAL PRIMARY KEY,
    codigo CHAR(1) UNIQUE NOT NULL,
    descricao VARCHAR(20) NOT NULL,
    pronome VARCHAR(10)
);

-- 2. TABELA DE ALUNOS (dados principais)
CREATE TABLE alunos (
    matricula INT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    sexo_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    FOREIGN KEY (sexo_id) REFERENCES sexos(id) ON DELETE RESTRICT
);

-- 3. TABELA DE ENDERE√áOS
CREATE TABLE enderecos (
    id SERIAL PRIMARY KEY,
    matricula INT NOT NULL,
    endereco_completo VARCHAR(200) NOT NULL,
    FOREIGN KEY (matricula) REFERENCES alunos(matricula) ON DELETE CASCADE
);

-- 4. TABELA DE TELEFONES
CREATE TABLE telefones (
    id SERIAL PRIMARY KEY,
    matricula INT NOT NULL,
    numero VARCHAR(15) NOT NULL,
    FOREIGN KEY (matricula) REFERENCES alunos(matricula) ON DELETE CASCADE
);

-- 5. TABELA DE PROFESSORES
CREATE TABLE professores (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(100) NOT NULL UNIQUE
);

-- 6. TABELA DE CURSOS
CREATE TABLE cursos (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(50) NOT NULL UNIQUE,
    professor_id INT NOT NULL,
    FOREIGN KEY (professor_id) REFERENCES professores(id) ON DELETE RESTRICT
);

-- 7. TABELA DE MATR√çCULAS (relacionamento N para N entre alunos e cursos)
CREATE TABLE matriculas (
    id SERIAL PRIMARY KEY,
    matricula INT NOT NULL,
    curso_id INT NOT NULL,
    nota DECIMAL(4,2),
    data_matricula DATE DEFAULT CURRENT_DATE,
    FOREIGN KEY (matricula) REFERENCES alunos(matricula) ON DELETE CASCADE,
    FOREIGN KEY (curso_id) REFERENCES cursos(id) ON DELETE CASCADE,
    UNIQUE(matricula, curso_id) -- Evita matr√≠cula duplicada no mesmo curso
);

-- ========================================
-- INSERINDO OS DADOS NORMALIZADOS
-- ========================================

-- Passo 1: Inserir Sexos (inclus√£o e diversidade)
INSERT INTO sexos (codigo, descricao, pronome) VALUES
('M', 'Masculino', 'ele/dele'),
('F', 'Feminino', 'ela/dela'),
('N', 'N√£o-bin√°rio', 'elu/delu'),
('O', 'Outro', 'elu/delu'),
('P', 'Prefiro n√£o dizer', NULL);

-- Passo 2: Inserir Professores
INSERT INTO professores (nome) VALUES
('Prof. Carlos Eduardo'),
('Profa. Juliana Santos');

-- Passo 3: Inserir Cursos (com os professores)
INSERT INTO cursos (nome, professor_id) VALUES
('PostgreSQL Essencial', 1),  -- Professor Carlos Eduardo (id 1)
('Python para Dados', 2);     -- Professora Juliana Santos (id 2)

-- Passo 4: Inserir Alunos (agora com sexo_id)
INSERT INTO alunos (matricula, nome, sexo_id) VALUES
(1001, 'Alice Silva', 2),      -- Feminino
(1002, 'Bruno Mendes', 1),     -- Masculino
(1003, 'Sam Oliveira', 3),     -- N√£o-bin√°rio
(1004, 'Jordan Santos', 5),    -- Prefiro n√£o dizer
(1005, 'Taylor Lima', 3);      -- N√£o-bin√°rio

-- Passo 5: Inserir Endere√ßos
INSERT INTO enderecos (matricula, endereco_completo) VALUES
(1001, 'Rua das Flores, 150 - S√£o Paulo'),
(1002, 'Av. Central, 500 - Rio de Janeiro'),
(1003, 'Rua Augusta, 200 - S√£o Paulo'),
(1004, 'Av. Paulista, 1000 - S√£o Paulo'),
(1005, 'Rua Oscar Freire, 300 - S√£o Paulo');

-- Passo 6: Inserir Telefones
INSERT INTO telefones (matricula, numero) VALUES
(1001, '(11) 98765-4321'),
(1001, '(11) 3333-2222'),  -- Alice tem 2 telefones
(1002, '(21) 99999-1111'),
(1003, '(11) 97777-5555'),
(1003, '(11) 96666-4444'),
(1004, '(11) 95555-3333'),
(1005, '(11) 94444-2222'),
(1005, '(11) 93333-1111'),
(1005, '(11) 92222-0000'); -- Taylor tem 3 telefones

-- Passo 7: Inserir Matr√≠culas (com notas)
INSERT INTO matriculas (matricula, curso_id, nota) VALUES
(1001, 1, 9.50),  -- Alice em PostgreSQL
(1001, 2, 8.80),  -- Alice em Python
(1002, 1, 7.00),  -- Bruno em PostgreSQL
(1003, 2, 9.20),  -- Sam em Python
(1004, 1, 8.50),  -- Jordan em PostgreSQL
(1004, 2, 7.80),  -- Jordan em Python
(1005, 1, 9.00);  -- Taylor em PostgreSQL

-- ========================================
-- CONSULTAS √öTEIS
-- ========================================

-- Ver todos os dados de um aluno (igual √† tabela original, mas com sexo por extenso)
SELECT 
    a.matricula,
    a.nome,
    s.descricao as sexo,
    s.pronome,
    e.endereco_completo,
    STRING_AGG(DISTINCT t.numero, ', ') as telefones,
    STRING_AGG(DISTINCT c.nome, ', ') as cursos,
    STRING_AGG(DISTINCT p.nome, ', ') as professores,
    AVG(m.nota) as media_notas
FROM alunos a
LEFT JOIN sexos s ON a.sexo_id = s.id
LEFT JOIN enderecos e ON a.matricula = e.matricula
LEFT JOIN telefones t ON a.matricula = t.matricula
LEFT JOIN matriculas m ON a.matricula = m.matricula
LEFT JOIN cursos c ON m.curso_id = c.id
LEFT JOIN professores p ON c.professor_id = p.id
WHERE a.matricula = 1001
GROUP BY a.matricula, a.nome, s.descricao, s.pronome, e.endereco_completo;

-- Ver cursos de um aluno com notas e professores
SELECT 
    a.nome as aluno,
    s.descricao as sexo,
    s.pronome,
    c.nome as curso,
    p.nome as professor,
    m.nota
FROM alunos a
JOIN sexos s ON a.sexo_id = s.id
JOIN matriculas m ON a.matricula = m.matricula
JOIN cursos c ON m.curso_id = c.id
JOIN professores p ON c.professor_id = p.id
WHERE a.matricula = 1003;  -- Sam (n√£o-bin√°rio)

-- Ver todos os alunos de um curso com diversidade
SELECT 
    c.nome as curso,
    p.nome as professor,
    a.nome as aluno,
    s.descricao as sexo,
    m.nota
FROM cursos c
JOIN professores p ON c.professor_id = p.id
JOIN matriculas m ON c.id = m.curso_id
JOIN alunos a ON m.matricula = a.matricula
JOIN sexos s ON a.sexo_id = s.id
WHERE c.nome = 'PostgreSQL Essencial'
ORDER BY m.nota DESC;

-- Ver alunos e seus telefones
SELECT 
    a.nome as aluno,
    s.descricao as sexo,
    s.pronome,
    t.numero as telefone
FROM alunos a
JOIN sexos s ON a.sexo_id = s.id
JOIN telefones t ON a.matricula = t.matricula
ORDER BY a.nome;

-- Estat√≠sticas de diversidade nos cursos
SELECT 
    c.nome as curso,
    s.descricao as sexo,
    COUNT(*) as quantidade_alunos,
    ROUND(AVG(m.nota), 2) as media_notas
FROM cursos c
JOIN matriculas m ON c.id = m.curso_id
JOIN alunos a ON m.matricula = a.matricula
JOIN sexos s ON a.sexo_id = s.id
GROUP BY c.nome, s.descricao
ORDER BY c.nome, quantidade_alunos DESC;

-- Ver todos os sexos cadastrados (para refer√™ncia)
SELECT * FROM sexos ORDER BY id;
    </code></pre>
            </div>
          </div>
        </div>

        <h2>Menu</h2>
        <div class="mt-4">
          <!-- <a href="./aula4.html" class="btn btn-primary">Pr√≥xima aula ‚Üí</a> -->
          <a href="./../index.html" class="btn btn-outline-secondary"
            >‚Üê Voltar ao In√≠cio</a
          >
          <a href="./../aulas.html" class="btn btn-outline-secondary"
            >‚Üê Voltar √†s aulas por data</a
          >
        </div>
      </main>
    </div>

    <script src="./../assets/js/sidebar.js"></script>
    <script src="./../assets/js/table-of-contents.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>
  </body>
</html>
